const pino = require('pino')({
  level: 'jnstrument',
  levelVal: 13
});

///////////////////////////////////////////////////////////////////////////////

module.exports = Events();

let scopeCounter = 0;

///////////////////////////////////////////////////////////////////////////////

function Events( fileName ) {
  
  return {
    i: enterScope,
    o: exitScope,
  };

///////////////////////////////////////////////////////////////////////////////
         
  function enterScope(parentScopeId){
    const scopeId = ++scopeCounter;
    
    pino.jnstrument({"type": "enter", "id": scopeId, "parent": parentScopeId});
    return scopeId;
  }
  
///////////////////////////////////////////////////////////////////////////////
         
  function exitScope(returns, scopeId){
    pino.jnstrument({"type": "exit", "id": scopeId, "return": !!returns});

    return returns;
  }
  
///////////////////////////////////////////////////////////////////////////////

}