(function($, undefined) {	
	var EventEmitter = function(){
/*/////////////////////////////////////////////////////////////////////////////
	Private Properties
/*/////////////////////////////////////////////////////////////////////////////
		var listener= {"all":[]};
		var stopped = true;
/*/////////////////////////////////////////////////////////////////////////////
	Private Methods
/*/////////////////////////////////////////////////////////////////////////////
/*/////////////////////////////////////////////////////////////////////////////
	Public Methods
/*/////////////////////////////////////////////////////////////////////////////
		this.emitEvent = function(data, answerCallback, eventName) {
			if(stopped) return;
			var receiver = $.extend([],listener["all"], listener[eventName] || []);
			var now = Date.now();
			for(var i=0; i<receiver.length; i++) 
				if(receiver[i]) receiver[i](data, answerCallback, now, this);
		}
///////////////////////////////////////////////////////////////////////////////
		this.activate = function() {
			stopped = false;
		}		
///////////////////////////////////////////////////////////////////////////////
		this.deactivate = function() {
			stopped = true;	
		}
///////////////////////////////////////////////////////////////////////////////
		this.isActive = function(){
			return !stopped;
		}
///////////////////////////////////////////////////////////////////////////////
		this.addListener = function(eventName, callback){
			if(typeof(eventName) === "function" && callback === undefined) {
				callback=eventName;
				eventName="all";
			}

			if(!listener[eventName]) listener[eventName]=[];
			listener[eventName].push(callback);
		}
///////////////////////////////////////////////////////////////////////////////
		this.removeListener = function(eventName, callback) {
			if(typeof(eventName) === "function" && callback === undefined) {
				callback=eventName;
				eventName="all";
			}
			delete listener[eventName][listener[eventName].indexOf(callback)];
		}
	}
///////////////////////////////////////////////////////////////////////////////
	module.exports = require("../Class.js").abstract(EventEmitter);
})(jQuery)